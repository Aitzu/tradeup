<h2>Job Search</h2>
<%= form_tag jobs_path, method: :get do %>
<%= label_tag :category %>
<%= collection_select(:job, :category_id, JobCategory.all, :id, :category, :prompt => true) %> 
<%= label_tag :postcode %> 
<%= text_field_tag :postcode %>
<%= submit_tag "Search" %>
<%= link_to "Clear", jobs_path %>
<% end %>

<%# search result message %>
<p><%= @message %></p>

<table>
  <thead>
    <tr>
      <th>Category</th>
      <th>Postcode</th>
      <th>Price</th>
      <th>Time</th>
      <th>Title</th>
      <%# <th>Job Location</th>
      <th>Creator</th>
      <th>Job Status</th> %>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @jobs.each do |job| %>
      <tr>
        <td><%= job.job_category.category %></td>
        <td><%= job.postcode %></td>
        <td><%= number_to_currency(job.price/100.0) %></td>
        <td><%= job.tenant_available_time %></td>
        <td><%= job.title %></td>
        <%# to comment out the info we currently don't wanna show %>
        <% if false %>
          <td><%= job.city %>, <%= job.state %></td>
          <td>
            <a href="user_profiles/<%=job.users.first.user_profile.id%>">
              <%= job.users.first.username %>
            </a>
          </td>
          <td><%= job.job_status.status.capitalize %></td>
        <% end %>

        <%# links %>
        <td><%= link_to 'Job Details', job %></td>
        <% if !current_user.nil? && current_user.id == job.users.first.id %>
          <td><%= link_to 'Edit', edit_job_path(job) %></td>
          <td><%= link_to 'Delete', job, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>
